# [Vue] 컴포넌트 5- 슬롯을 사용한 컨텐츠 배포

컴포넌트를 사용할 때 다음과 같이 컴포넌트를 구성하는 것이 좋다.
vue 컴포넌트는 수 많은 하위 엘리먼트를 포함하거나 다른 Vue 컴포넌트 안에 포함되기도 한다.

```pug
app
  app-header
  app-footer
```
와 같이 app 컴포넌트 태그 안에 `app-header`와 `app-footer` 컴포넌트 태그를 포함하는 루트 인스턴스 템플릿이 있다고 할 때,
1. `app` 컴포넌트는 어떤 컨텐츠를 받을지 모르며 그것은 `app`이 사용하는 컴포넌트에 의해 결정된다.
2. `app` 컴포넌트에는 자체 템플릿이 있을 가능성이 크다.
3. `app` 컴포넌트에는 `app-header`, `app-footer` 컴포넌트 외에도 다른 템플릿이 있을 수도 있다.
위의 코드를 안전하게 동작하게하려면 하위 Vue 컴포넌트들과 상위 Vue 컴포넌트의 자체 템플릿이 매끄럽게 표현되어야 한다.

Vue.js는 이렇게 표시하는 프로세스를 **컨텐츠 배포**라고 한다.
> Vue.js는 현재 웹 컴포넌트 사양 초안을 모델로한 콘텐츠 배포 API를 구현하며 원본 콘텐츠의 배포판 역할을 하기 위해 특수한 `slot`엘리먼트를 사용한다.

루트 인스턴스나 Vue 컴포넌트에 있는 상태 값을 화면에 표시하려면 인스턴스나 컴포넌트의 자체 템플릿에 문자열 보간법이나 v-bind를 사용해야 한다.

### 범위 컴파일

내용이 컴파일되는 범위를 명확히 해야한다.

```pug
child-component {{ message }}
```
위의 코드에서 *message*가 부모 컴포넌트의 데이터 또는 자식 컴포넌트 데이터 중 어디에 바인딩 되어야 할까?
=> 부모 컴포넌트의 데이터에 바인딩되어야한다.
상위 템플릿의 모든 내용은 상위 범위 파일로 컴파일된다. 하위 템플릿의 모든 내용은 하위 범위에서 컴파일된다.

**루트 인스턴스 템플릿에서 사용된 머스태시 문법과 v-bind 디렉티브 설정값으로 사용한 상태 값은 하위 컴포넌트에서는 찾지 않고 루트 인스턴스에서만 찾는다.**
Vue 컴포넌트를 사용하는 템플릿 컴파일은 보통 상위 범위 컴파일이라 하며 Vue 컴포넌트의 상태 값을 찾지 않는다. 


따라서 `child-component` 컴포넌트 템플릿에서 컴포넌트에 있는 message 상태 값을 확인하려면 아래와 같이 작성해야 한다.
```pug
child-component
```
```js
Vue.component('child-component', {
  template: `<div> {{ message }} </div>`,
  data() {
    return {
      message: '안녕하세요'
    }
  }
})
```
`child-component` 컴포넌트 안 `template` 옵션에 설정한 템플릿은 `child-component` 컴포넌트의 *message* 상태 값이 보이지만 루트 인스턴스의 템플릿에서 참조하는 상태 값은 컴포넌트 안의 상태 값까지 탐색하지 않기 때문이다.

### 단일 슬롯

일반적으로 Vue 컴포넌트를 사용하는 상위 템플릿은 Vue 컴포넌트를 호출하는 시점에 Vue 컴포넌트 태그 안의 Vue 컴포넌트 템플릿 내용으로 변경한다.
상위 인스턴스 템플릿에서 Vue 컴포넌트 태그 내요에 특정 엘리먼트를 추가하고 그 내용이 다시 출력되도록 할 때는 `slot` 엘리먼트를 Vue 컴포넌트 템플릿에 추가하면 된다.

```pug
// my-component 컴포넌트
div
  h2 나는 자식 컴포넌트의 제목입니다.
  slot 제공된 컨텐츠가 없는 경우에만 볼 수 있습니다.
```
하위 컴포넌트 템플릿에 최소한 하나의 `slot` 콘텐츠가 포함되어 있지 않으면 부모 콘텐츠가 삭제된다.
속성이 없는 슬롯이 하나 뿐인 경우 전체 내용 조각이 DOM의 해당 위치에 삽입되어 슬롯 자체를 대체한다.
**원래 `slot` 태그 안에 있는 내용은 대체 콘텐츠로 간주된다.**
대체 콘텐츠는 하위 범위에서 컴파일되며 호스팅 엘리먼트가 비어있고 삽입할 콘텐츠가 없는 경우에만 표시된다.

< Vue 컴포넌트 템플릿과 상위 인스턴스 템플릿을 적용한 단일 슬롯 예시 >
```pug
// my-component 컴포넌트를 사용하는 부모 컴포넌트
div
  h1 나는 부모 컴포넌트의 제목입니다.
  my-component
    p 이것은 원본 컨텐츠입니다.
    p 이것은 원본 중 추가 컨텐츠 입니다.
```
이는 아래와 같이 렌더링된다.
```pug
div
  h1 나는 부모 컴포넌트의 제목입니다.
  h2 나는 자식 컴포넌트의 제목입니다.
  p 이것은 원본 컨텐츠입니다.
  p 이것은 원본 중 추가 컨텐츠 입니다.
```
`h2` 태그는 Vue 컴포넌트의 템플릿이자 `p`태그 2개는 Vue 컴포넌트 템플릿이 아니라 상위 인스턴스의 템플릿이다. `my-component` 태그의 내용으로 삽입되어 있는 부분이다.
Vue 컴포넌트 템플릿에 있는 `slot` 엘리먼트의 내용이 Vue 컴포넌트 태그의 내용으로 대체되기 때문이다.

### 이름을 가지는 슬롯

Vue 컴포넌트 안에 슬롯을 다수 배치해야 할 경우가 있다.
`slot` 엘리먼트는 특별한 속성인 `name`을 가지고 있다.
이 속성을 어떻게 내용을 배포해야 하는지를 더 커스터마이징하는데 사용할 수 있다.
명명되지 않은 슬롯이 하나 있을 수 있다.
기본 슬롯은 일치하지 않는 콘텐츠의 포괄적인 컨텐츠 역할을 한다.
기본슬롯이 없으면 일치하지 않는 콘텐츠가 삭제된다.

```pug
// 자식 컴포넌트(app-layout)
.container
  header
    slot(name="header")
  main
    slot
  footer
    slot(name="footer")
```
```pug
// 부모 컴포넌트
app-layout
  h1(slot="header") 여기에 페이지 제목이 위치합니다.
  p 메인 컨텐츠의 단락입니다.
  p 하나 더 있습니다.
  p(slot="footer") 여기에 연락처 정보입니다.
```
는 아래와 같이 렌더링 된다.
```pug
.container
  header
    h1 여기에 페이지 항목이 위치합니다.
  main
    p 메인 컨텐츠의 단락입니다.
    p 하나 더 있습니다.
  footer
    p 여기에 연락처 정보입니다.
```
이름을 지정하지 않은 p 엘리먼트는 모두 `main`에 포함된다.

콘텐츠 배포 API는 함께 구성할 컴포넌트를 디자인 할 때 매우 유용한 메커니즘이다.

### 범위를 가지는 슬롯

범위가 지정된 슬롯은 이미 렌더링된 엘리먼트 대신 재사용 가능한 템플릿(데이터 전달 가능)으로 작동하는 특별한 유형의 슬롯이다.

prop을 컴포넌트에 전달하는 것처럼, 하위 컴포넌트에서 단순히 데이터를 슬롯에 전달하면 된다.
```pug
// 자식 컴포넌트
.child
  slot(text="hello from child")
```
**부모에서** 특별한 속성 `slot-scope`를 가진 `template` 엘리먼트가 있어야 한다.
이것은 범위를 가지는 슬롯을 위한 템플릿임을 나타낸다.
`slot-scope`의 값은 자식으로부터 전달된 props 객체를 담고있는 임시 변수의 이름이다.

```pug
.parent
  child
    template(slot-scope="props")
      span hello from parent
      span {{ props.text }}
```
위를 렌더링하면 출력은 다음과 같다.
```pug
.parent
  .child
    span hello from parent
    span hello from child
```

> 2.5.0+ 에서, `slot-scope`는 더 이상 `template` 뿐 아니라 컴포넌트나 엘리먼트에서도 사용할 수 있다.

범위가 지정된 슬롯의 일반적인 사례는 컴포넌트 사용자가 리스트의 각 항목을 렌더링 하는 방법을 사용자가 정의할 수 있는 리스트 컴포넌트이다.

```pug
// 리스트 컴포넌트의 템플릿
ul
  slot(name="item" v-for="item in items" :text="item.text")
```

```pug
// 부모 컴포넌트
my-awesome-list(:items="items")
  li(slot="item" slot-scope="props" class="my-fancy-item") {{ props.text }}
```

**디스트럭처링**
`slot-scope` 값은 실제로 함수 서명의 인수 위치에 나타낼 수 있는 유효한 JavaScript 표현식이다.
```pug
child
  span(slot-scope="{ text }") {{ text }}
```
